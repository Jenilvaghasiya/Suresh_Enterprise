<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        {{{css}}}
        
        /* Critical styles for repeating header */
        @media print {
          thead { 
            display: table-header-group;
          }
          tfoot { 
            display: table-footer-group;
          }
          .page-header {
            page-break-after: avoid;
          }
        }
        
        .page-header {
          width: 100%;
          margin-bottom: 0;
        }
        
        .page-header h1 {
          margin: 0;
          padding: 0;
          font-size: 28px;
          font-weight: bold;
          text-align: center;
        }
        
        .page-header .company-info {
          text-align: center;
          font-size: 11px;
          margin: 2px 0;
        }
        
        .page-header .header-divider {
          border-top: 2px solid #000;
          border-bottom: 2px solid #000;
          padding: 8px 0;
          margin: 8px 0;
          display: flex;
          justify-content: space-between;
        }
        
        .page-header .party-section {
          width: 48%;
        }
        
        .page-header .report-section {
          width: 48%;
          text-align: right;
        }
        
        .page-header .report-section h2 {
          margin: 0 0 4px 0;
          font-size: 22px;
          font-weight: bold;
        }
        
        .ledger-table {
          width: 100%;
          border-collapse: collapse;
        }
    </style>
</head>
<body>
  <div class="ledger-container">
    <table class="ledger-table">
      <thead>
        <tr>
          <th colspan="6" class="page-header-cell" style="border: none; padding: 0;">
            <div class="page-header">
              <h1>{{company.name}}</h1>
              <p class="company-info">{{#if company.address}}{{company.address}}{{else}}3rd Floor, Corporate Heights, Near KKV Circle, Kalawad Road, Rajkot, Gujarat - 360005{{/if}}</p>
              <p class="company-info"><strong>GSTIN:</strong> {{#if company.gstin}}{{company.gstin}}{{else}}24JJJJJ1234F1Z5{{/if}}</p>
              
              <div class="header-divider">
                <div class="party-section">
                  <p style="margin: 0 0 4px 0; font-weight: bold;">Party Details:</p>
                  <p style="margin: 2px 0; font-size: 11px;"><strong>Customer Name:</strong> {{customer.name}}</p>
                  {{#if customer.companyName}}
                  <p style="margin: 2px 0; font-size: 11px;"><strong>Company Name:</strong> {{customer.companyName}}</p>
                  {{/if}}
                  <p style="margin: 2px 0; font-size: 11px;"><strong>Address:</strong> {{#if customer.address}}{{customer.address}}{{else}}Rajkot ring road{{/if}}</p>
                  <p style="margin: 2px 0; font-size: 11px;"><strong>GSTIN:</strong> {{#if customer.gstin}}{{customer.gstin}}{{else}}24AAAAA1234F1Z5{{/if}}</p>
                </div>
                <div class="report-section">
                  <h2>LEDGER REPORT</h2>
                  {{#if dateRange}}
                  <p style="margin: 0; font-size: 11px;">{{dateRange}}</p>
                  {{/if}}
                </div>
              </div>
            </div>
          </th>
        </tr>
        <tr>
          <th>Sr. No.</th>
          <th>Date</th>
          <th>Reference</th>
          <th>Credit (₹)</th>
          <th>Debit (₹)</th>
          <th>Balance (₹)</th>
        </tr>
      </thead>
      <tbody>
        {{#if openingRow}}
        <tr>
          <td>0</td>
          <td>{{openingRow.date}}</td>
          <td>Opening Balance</td>
          <td>-</td>
          <td>-</td>
          <td>{{openingRow.balance}}</td>
        </tr>
        {{/if}}
        {{#each ledgerEntries}}
        <tr>
          <td>{{this.srNo}}</td>
          <td>{{this.date}}</td>
          <td>{{this.reference}}</td>
          <td>{{#if this.credit}}{{this.credit}}{{else}}-{{/if}}</td>
          <td>{{#if this.debit}}{{this.debit}}{{else}}-{{/if}}</td>
          <td>{{this.balance}}</td>
        </tr>
        {{/each}}
        {{#each emptyRows}}
        <tr>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
          <td>&nbsp;</td>
        </tr>
        {{/each}}
      </tbody>
    </table>

    <div class="closing-balance">
      <p>Closing Balance: <span>₹ {{closingBalance}}</span></p>
    </div>

    {{#if termsAndConditions}}
    <div class="footer-section">
      <h4>Terms & Conditions:</h4>
      {{#each termsAndConditions}}
      <p><strong>{{this.number}}.</strong> {{this.text}}</p>
      {{/each}}
    </div>
    {{/if}}
  </div>
</body>
</html>